# ðŸ¤– Build a Smart AI Agent to Generate Charts from CSV in Azure

Welcome to the **hands-on lab** of modern AI! In this demo, we're going to teach an AI agent how to read a CSV ðŸ“‘, create a filtered bar chart ðŸ“ˆ, and send it back to us â€” all in **Azure AI Studio** using **Azure OpenAI + Agents**.

Itâ€™s not just a demo â€” itâ€™s a **mind-shift** into how AI agents can do real-world work like analysts, coders, and artists. But without coffee â˜• or complaints.

---

<div style="text-align: center;">
    <img src="images/agent-demo-1.png" alt="agent-demo-1" style="border-radius: 10px; width: 90%;">
</div>

---

## ðŸ§  What This Demo Proves

This agent solution is an applied version of the â€œagentâ€ concept â€” where **LLMs donâ€™t just answer your prompts**, but actually **do stuff for you**.

In this case, it:

1. Reads a .csv file (uploaded to Azure)
2. Filters the data for the â€œTRANSPORTATIONâ€ sector
3. Plots a bar chart for operating profit
4. Sends you back the resulting `.png` image

And it does all this by:

- Writing a Python script ðŸ (by itself!)
- Executing it using the Code Interpreter ðŸ§°
- Returning the image ðŸŽ¨ as a downloadable file

Letâ€™s dive into how this works!

---

## ðŸš€ Step-by-Step: Agent-Powered Data Visualization

### ðŸ—ï¸ 1. Create the AI Project in Azure AI Foundry

Before anything, you need to **log in to Azure** using:

```bash
az login
```

Then, get the **project connection string** from Azure AI Foundry > Hub > Project > Overview.

Example format:

```env
<HostName>;<AzureSubscriptionId>;<ResourceGroupName>;<HubName>
```

We use this connection string to create an `AIProjectClient` in Python, which lets you talk to your Azure AI services.

```python
project_client = AIProjectClient.from_connection_string(
    credential=DefaultAzureCredential(),
    conn_str="your_connection_string_here"
)
```

---

### ðŸ“‚ 2. Upload the CSV File

The `.csv` file is uploaded as a resource **inside the Agent container**:

```python
file = project_client.agents.upload_file_and_poll(
    file_path="nifty_500_quarterly_results.csv",
    purpose=FilePurpose.AGENTS
)
```

This is like giving the Agent a "memory stick" ðŸ’¾ to work with.

---

### ðŸ§° 3. Create the Code Interpreter Tool

This is the **real magic wand** ðŸª„. Youâ€™re giving your Agent the power to not just think â€” but to code and execute that code.

```python
code_interpreter = CodeInterpreterTool(file_ids=[file.id])
```

> Think of this like installing Python on the Agent's brain and pointing it to your `.csv`.

---

### ðŸ§‘â€ðŸ’¼ 4. Create the Agent (aka "The Analyst")

Now we create the Agent using GPT-4o-mini and bind it with the Code Interpreter tool:

```python
agent = project_client.agents.create_agent(
    model="gpt-4o-mini",
    name="my-agent",
    instructions="You are a helpful agent",
    tools=code_interpreter.definitions,
    tool_resources=code_interpreter.resources
)
```

âœ”ï¸ Youâ€™ve just created a **custom AI analyst** that understands your orders and has the power to act.

---

### ðŸ§µ 5. Create a Thread and Send a Message (Prompt)

This is like opening a chat window with the Agent.

```python
thread = project_client.agents.create_thread()
message = project_client.agents.create_message(
    thread_id=thread.id,
    role="user",
    content="Could you please create a bar chart in the TRANSPORTATION sector for the operating profit from the uploaded CSV file and provide the file to me?"
)
```

The Agent takes this message, figures out the task, and writes Python to solve it.

---

### ðŸ§  6. Run the Agent Workflow

This is where all the work happens â€” internally, Azure spins up the LLM, runs the Python code on the Code Interpreter tool, and returns results.

```python
run = project_client.agents.create_and_process_run(
    thread_id=thread.id,
    agent_id=agent.id
)
```

If everything goes well:

```python
Run finished with status: succeeded
```

---

### ðŸ–¼ï¸ 7. Receive and Save the Image

The generated chart is now ready! Letâ€™s save it:

```python
for image_content in messages.image_contents:
  project_client.agents.save_file(file_id=image_content.image_file.file_id, file_name="chart.png")
```

> ðŸŽ‰ Now you have a beautifully filtered bar chart ready for presentation or reporting.

---

### ðŸ§¹ 8. Cleanup: Delete File, Thread, Agent

Donâ€™t forget to clean up and save your Azure credits:

```python
project_client.agents.delete_file(file.id)
project_client.agents.delete_agent(agent.id)
project_client.agents.delete_thread(thread.id)
```

---

## ðŸŽ¯ Whatâ€™s Really Happening Behind the Scenes?

Hereâ€™s a visual breakdown:

---

```mermaid
---
config:
  look: handDrawn
  layout: elk
  elk:
    mergeEdges: false
---
graph LR
  A[Local Python Script] -->|Upload CSV & Prompt| B[Azure AI Agent]
  B -->|Prompt Sent| C[LLM: GPT-4o-mini]
  C -->|Python Code| D[Code Interpreter]
  D -->|Executes Script| E[Generates Image]
  E -->|Saves File| B
  B -->|Sends Result| A
```

---

ðŸ¤– **LLM** writes code (like a developer)  
ðŸ§° **Code Interpreter** runs it (like a terminal)  
ðŸ“¦ **Agent** orchestrates everything

---

## ðŸ’¥ Why This Is Awesome

- â›” Agent != LLM.
- ðŸ‘‰ Agent = LLM + Tools + Memory + Autonomy.
- âœ… Zero hallucination â€” image is created from actual CSV data
- ðŸ” Grounded â€” 100% factual, not "guessed"
- ðŸ§‘â€ðŸ« Replaces repetitive analyst tasks (Excel â†’ chart)

---

## ðŸ›‘ Key Insight

> **LLMs donâ€™t â€œdoâ€ â€” they â€œthink.â€**
>
> **Agents do.**

Thatâ€™s the philosophical separation. Agents are **the hands and legs of LLMs** â€” the bridge between ideas and action.

In this case, you didnâ€™t have to:

- Write a single line of data parsing code
- Plot anything with matplotlib
- Even open Excel

ðŸ’¡ The agent did it all from your intent.

---

## ðŸ’¬ Final Word

This is only the beginning. Imagine building:

- ðŸ’¼ Executive assistants that file reports
- ðŸ§ª Research bots that analyze scientific papers
- ðŸŽ¥ Media agents that edit video clips
- ðŸ“š Tutors that teach students with diagrams

...all from text prompts and tools.

Welcome to the **Agentic Futureâ„¢** ðŸ˜ˆ.
