# ğŸ§¾ Azure AI Document Intelligence â€“ Custom Models Explained (Classification + Extraction)

Azure's Custom Document Intelligence lets you train your own models to understand specific document types and layouts â€” ideal when your documents donâ€™t match any prebuilt templates.

---

## ğŸ“¦ What Are Custom Models?

Custom models allow you to **train AI to understand your unique documents** â€” whether itâ€™s a weird invoice format, a rare tax certificate, or even handwritten forms.

There are **two flavors** of custom models:

| ğŸ¦ Type               | ğŸ° Purpose                                                              |
| --------------------- | ----------------------------------------------------------------------- |
| ğŸ” **Classification** | Identify what type of document this is (e.g., Invoice vs. W8 Tax Form)  |
| ğŸª„ **Extraction**      | Pull specific fields from the document (e.g., Invoice ID, Total Amount) |

---

## ğŸ§  1. Custom Document Classification Model

### âœ… What It Does

Given a random document, it tells you what "type" it is. Itâ€™s like a receptionist sorting your mail into "Invoices", "Tax forms", "Receipts", etc.

### ğŸ”„ Workflow

---

<div align="center">

```mermaid
flowchart TD
    A[Upload Training Docs<br/> to Blob Storage] --> B[Group Docs by Folder Name]
    B --> C[Create Project in Studio]
    C --> D[Label by Folder Names]
    D --> E[Train Model]
    E --> F[Test with New Docs]
    F --> G[Receive Classification + Confidence Score]
```

</div>

---

### ğŸ“ Folder Structure (ğŸ“‚ Pro Tip)

Organize training data by **folder names** representing labels!

```ini
ğŸ“ training-data/
â”œâ”€â”€ ğŸ“‚ invoice/
â”‚   â”œâ”€â”€ invoice1.pdf
â”‚   â””â”€â”€ invoice2.pdf
â”œâ”€â”€ ğŸ“‚ tax_doc/
â”‚   â”œâ”€â”€ w8form1.pdf
â”‚   â””â”€â”€ w8form2.pdf
```

Azure will ask: _"Use folder names as labels?"_ â€” Say **YES** ğŸ™Œ

### ğŸ§ª Test Result Example

| ğŸ§¾ Document            | ğŸ“Œ Predicted Type | ğŸ¯ Confidence |
| ---------------------- | ----------------- | ------------- |
| `invoice_test.jpg`     | Invoice           | 77% âœ…        |
| `tax_certificate.pdf`  | Tax Doc           | 84% âœ…        |
| `passport_unknown.pdf` | Tax Doc (?)       | 41% âš ï¸        |

> ğŸ¤– **Tip:** If confidence < 50%, you can flag it as **"Unknown"** in your app.

---

## ğŸ§  2. Custom Document Extraction Model

### âœ… What It Does

This model pulls out the **key fields** from documents: names, totals, IDs, addresses, etc.

### ğŸ—ºï¸ Visual Example

---

<div align="center">

```mermaid
graph TD
    A["Upload sample PDFs (5+)"] --> B[Label Fields: Invoice ID, Total, Name]
    B --> C[Train Extraction Model]
    C --> D[Test on similar docs]
    D --> E[Extract structured JSON output]
```

</div>

---

### ğŸ§° Required Training Data

At least **5 documents** with:

- ğŸ§¾ Identical structure (e.g., same invoice layout)
- âœï¸ Labeled fields like `Invoice ID`, `Total`, `Customer Name`

### ğŸ§ª Output Example

Given a PDF, the model returns this:

```json
{
  "fields": {
    "InvoiceID": {
      "value": "INV-2045",
      "confidence": 0.94
    },
    "CustomerName": {
      "value": "TechBazaar LLC",
      "confidence": 0.91
    }
  }
}
```

### ğŸ’¡ Real Use Cases

- ğŸ¦ Banks: extract account details from forms
- ğŸ§¾ Invoice processing: auto-read totals, due dates
- ğŸ¥ Healthcare: extract fields from lab reports or prescriptions

---

### ğŸ”§ Behind the Scenes: How It Works

Every doc is scanned using OCR (Optical Character Recognition). You help the model by drawing boxes around text and giving them labels (e.g., "Customer Name").

Then Azure learns the pattern of where fields live and what they look like.

You can:

- ğŸ–ï¸ Use **auto-labeling** (based on known doc formats like invoices)
- âœï¸ Or manually draw and label fields (drag & drop regions)

---

### ğŸ“¤ Storage & Labeling Best Practices

| ğŸ” Tip                                           | ğŸ“ Why It Matters                                                |
| ------------------------------------------------ | ---------------------------------------------------------------- |
| Store training docs in **Blob Storage**          | Avoids upload errors and allows versioning                       |
| Use **folder names** for labels (classification) | Azure auto-labels for you                                        |
| Label at least **5 docs** per type               | More is better, but 5 is minimum                                 |
| Don't mix formats in one project                 | Separate PDF, image types, or layouts to reduce model confusion  |
| Upload from BLOB â€” not Studio                    | Studio uploads for training can fail; always prefer Blob Storage |

---

### ğŸ§ª Testing Phase

Once trained:

1. Upload a **new document** (JPEG, PDF, etc.)
2. Azure tells you:

   - âœ… What type of document it is (classification)
   - ğŸ§¾ Which fields it extracted + confidence (extraction)

3. Use that in your app workflow!

---

### ğŸ’¬ Sample Output: Extraction JSON

```json
{
  "DocumentType": "Invoice",
  "ExtractedFields": {
    "TotalAmount": "$295.40",
    "InvoiceNumber": "INV1020",
    "DueDate": "2024-09-01"
  }
}
```

---

### ğŸ¤– Bonus: Query Fields

If you forgot to train for something (like â€œVAT Amountâ€), you can use **Query Fields**:

```python
model.query_fields = ["VAT Amount"]
```

Butâ€¦ ğŸ›‘ accuracy is lower than trained fields. Always better to label in training!

---

## ğŸ§  Summary

| Feature           | Classification          | Extraction                    |
| ----------------- | ----------------------- | ----------------------------- |
| ğŸ¯ Goal           | Identify doc **type**   | Pull fields from a doc        |
| ğŸ§¾ Input Docs     | Grouped by folder name  | 5+ with same layout           |
| ğŸ“¦ Output         | Label + confidence      | JSON with fields + confidence |
| ğŸ§° Ideal Use Case | Routing, categorization | Invoices, forms, ID cards     |

---

## âœ… Final Tips

- ğŸ’¡ Use **Blob Storage** for training docs
- ğŸ§¹ Keep your training data **clean and consistent**
- ğŸ›¡ï¸ Mask any PII before uploading
- ğŸ“¦ For document pipelines, use it in combo with Form Recognizer prebuilt models
- âš™ï¸ Use the **Document Intelligence Studio** to label and test visually
